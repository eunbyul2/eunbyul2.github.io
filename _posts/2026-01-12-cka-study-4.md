---
layout: post
title: "CKA 정리: Scheduling, Resource, Static Pod, PriorityClass 완전 정복"
date: 2026-01-12 22:50:00 +0900
categories: [Kubernetes, CKA]
tags: [kubernetes, cka, scheduling, static-pod, daemonset, priorityclass, resources]
published: true
---

## 1. Kubernetes 스케줄링 기본 개념
### 1-1) Scheduler의 역할
- Pod를 어떤 Node에 배치할지 결정
- CPU/Memory 요청(requests), 제약조건을 기준으로 판단
- 조건을 만족하는 Node가 없으면 Pod는 Pending 상태

### 1-2) Node Selector와 Node Affinity
- Node Selector: 단순 key=value 매칭
- Node Affinity: AND/OR/NOT 같은 복잡한 조건 가능
- `requiredDuringSchedulingIgnoredDuringExecution`은 강제 조건

### 1-3) Taints & Tolerations
- Node가 Pod를 거부하도록 설정
- Taint = Node의 방어막
- Toleration = Pod의 면역
- 단독 사용 시 '배치 보장'은 되지만 '전용화'는 불완전

### 1-4) Node Affinity + Taints 조합
- Taints/Tolerations: 다른 Pod 유입 차단
- Node Affinity: 내 Pod가 지정 Node로만 가도록 제한
- 두 개를 함께 써야 Node 전용화 가능

## 2. Resource Requests & Limits
### 2-1) CPU와 Memory 요청(Requests)
- Scheduler가 Pod 배치 시 참고하는 최소 요구량
- CPU 단위: vCPU, millicore (500m = 0.5 CPU)
- Memory 단위: Mi(Mebibyte), Gi(Gibibyte)

### 2-2) CPU vs vCPU vs Memory 단위
- vCPU: 논리 CPU (클라우드 기준)
- Mi: 1024^2 Byte
- CPU는 throttle, Memory는 OOM Kill

### 2-3) Limits의 의미
- CPU limit 초과: 느려질 뿐
- Memory limit 초과: Pod 강제 종료(OOMKilled)

### 2-4) 이상적인 설정 전략
- CPU: requests만 설정, limits 생략
- Memory: requests + limits 둘 다 설정

### 2-5) LimitRange와 ResourceQuota
- LimitRange: Pod 기본값 강제 (namespace 단위)
- ResourceQuota: namespace 전체 자원 상한

## 3. DaemonSet
### 3-1) DaemonSet이란?
- 모든 Node에 1개씩 Pod 보장
- Node 추가/삭제 시 자동 반영

### 3-2) 주요 사용 사례
- kube-proxy
- CNI (flannel, calico)
- 로그 수집, 모니터링 에이전트

### 3-3) ReplicaSet과 차이
- ReplicaSet: 개수 기준
- DaemonSet: Node 기준

## 4. Static Pod
### 4-1) Static Pod 개념
- kubelet이 직접 생성
- API Server 없이도 동작
- 로컬 manifest 파일 기반

### 4-2) Static Pod 경로
- kubelet 설정의 `staticPodPath`
- 일반적으로 `/etc/kubernetes/manifests`

### 4-3) Static Pod 확인 방법
- `kubectl get pods -A` (mirror pod)
- 이름에 Node 이름 포함
- annotation: `kubernetes.io/config.source: file`

### 4-4) Static Pod 생성/수정/삭제
- 생성: manifest 디렉터리에 YAML 추가
- 수정: 파일 수정
- 삭제: 파일 삭제 (kubectl delete로는 불가)

### 4-5) Static Pod vs DaemonSet
- Static Pod: kubelet 단독
- DaemonSet: API Server + Controller

## 5. PriorityClass
### 5-1) PriorityClass 개념
- Pod 중요도 정의
- 숫자 클수록 우선순위 높음
- cluster-scoped 리소스

### 5-2) 기본 PriorityClass
- system-cluster-critical
- system-node-critical

### 5-3) Pod에 PriorityClass 적용
```yaml
spec:
  priorityClassName: high-priority
```

### 5-4) Preemption (선점)
- 기본: 낮은 priority Pod 제거
- `preemptionPolicy: Never` 설정 시 제거 안 함

### 5-5) Priority 수정 전략
- Pod는 priority 수정 불가
- 삭제 후 재생성 필수

## 6. CKA 시험 실전 포인트

### 6-1) Static Pod 문제 풀이 루트
1. `kubectl get pods -A`
2. control-plane Pod 식별
3. `/etc/kubernetes/manifests` 확인

### 6-2) Priority 문제 풀이 루트
1. PriorityClass 존재 확인
2. Pod YAML에 연결
3. 삭제 후 재생성
4. Running 상태 확인

### 6-3) 자주 나오는 함정
- DaemonSet을 Static Pod로 착각
- kubectl delete로 Static Pod 삭제 시도
- Priority 수정 edit 시도

## 7. 전체 요약
- 스케줄링은 조건 + 리소스 + 우선순위의 조합
- Static Pod는 kubelet과 파일이 전부
- PriorityClass는 위기 상황에서 살아남는 기준
- CKA는 '어디를 확인해야 하는지'를 묻는다